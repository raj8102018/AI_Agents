from bson.objectid import ObjectId

output = [{'_id': ObjectId('67065bd575323e01f1945db9'), 'Company': 'All Points North', 'Website': 'apn.com', 'Industry': 'Mental Health Care', 'Address Street': '2205 Cordillera Way', 'City': 'Edwards', 'State': 'Colorado', 'Zip Code': 81632, 'Country': 'United States', 'Contact Number': '1 310 579 6169', 'First Name': 'Nippu', 'Last Name': 'Nagaraju', 'Job Title': 'Chief Executive Officer', 'Email': 'mrohithg@gmail.com', 'Linkedin URL': 'https://linkedincom/in/noahnordheimer52255333/', 'lead_type': 'Hot', 'outbound message': "Subject:  Streamlining Mental Health Care with AI Automation \\n\\nHi Nagaraj Nippu,\\n\\nI came across All Points North's impressive work in the mental health space and was excited to learn more about your organization. \\n\\nAs a leader in AI automation, we've seen how technology can significantly improve efficiency and care delivery in the healthcare industry. \\n\\nI'd be interested in connecting to discuss how AI solutions could potentially benefit All Points North.  Would you be open to a brief conversation?\\n\\nBest regards,\\n\\n[Your Name] \\n", 'Initial contact': 'No'}, {'_id': ObjectId('67065bd575323e01f1945dba'), 'Company': 'Alterg Inc', 'Website': 'alterg.com', 'Industry': 'Medical Equipment Manufacturing', 'Address Street': '48368 Milmont Dr', 'City': 'Fremont', 'State': 'California', 'Zip Code': 94538, 'Country': 'United States', 'Contact Number': '1 510 270 5900', 'First Name': 'Charles', 'Last Name': 'Chari', 'Job Title': 'Chief Executive Officer', 'Email': 'rohithgoud0199@gmail.com', 'Linkedin URL': 'https://wwwlinkedincom/in/charlesremsberg/', 'lead_type': 'Hot', 'outbound message': "Subject: Exploring AI Automation for Enhanced Efficiency at Alterg Inc\\n\\nDear Chari,\\n\\nI hope this email finds you well.\\n\\nMy name is [Your Name], and I'm reaching out from [Your Company]. We specialize in helping companies like Alterg Inc. leverage the power of AI automation to optimize their operations and drive significant results. \\n\\nI understand that Alterg Inc. is a leader in the Medical Equipment Manufacturing industry. I'm curious to know if you've considered exploring the potential of AI to automate tasks in your business, such as:\\n\\n* **Streamlining manufacturing processes**\\n* **Improving customer service efficiency**\\n* **Analyzing data for better decision-making**\\n\\nIf you're interested in learning more about how AI automation can benefit Alterg Inc., I'd be happy to schedule a brief introductory call. \\n\\nThank you for your time and consideration.\\n\\nSincerely,\\n\\n[Your Name] \\n[Your Company]\\n", 'Initial contact': 'No'}, {'_id': ObjectId('67065bd575323e01f1945dbb'), 'Company': '21st Century Healthcare, Inc', 'Website': '21stcenturyvitamins.com', 'Industry': 'Manufacturing', 'Address Street': '443 West Alameda Drive', 'City': 'Tempe', 'State': 'Arizona', 'Zip Code': 85282, 'Country': 'United States', 'Contact Number': '1 480 966 1215', 'First Name': 'Sheldon', 'Last Name': 'Cooper', 'Job Title': 'President', 'Email': 'kunamallarajendraprasad@gmail.com', 'Linkedin URL': 'https://wwwlinkedincom/in/leannewilhardt94513b15/', 'lead_type': 'cold', 'outbound message': "Subject: AI Automation for Manufacturing Efficiency\\n\\nHi Sheldon,\\n\\nI hope this email finds you well.\\n\\nMy name is [Your Name], and I work with [Your Company] â€“ a company dedicated to helping businesses like yours achieve higher levels of efficiency and productivity through AI automation.\\n\\nI noticed that 21st Century Healthcare, Inc. is a leading manufacturer in the industry, and I wanted to reach out and see if you're exploring ways to leverage AI technology in your operations.\\n\\nWe've helped many manufacturers streamline their processes, optimize resource allocation, and improve overall efficiency with our AI solutions. \\n\\nWould you be interested in learning more about how AI can benefit your manufacturing processes?\\n\\nBest regards,\\n\\n[Your Name] \\n", 'Initial contact': 'No'}, {'_id': ObjectId('67065bd575323e01f1945dbc'), 'Company': 'Bertec Corporation', 'Website': 'bertec.com', 'Industry': 'Health, Wellness & Fitness', 'Address Street': '2500 Citygate Dr', 'City': 'Columbus', 'State': 'Ohio', 'Zip Code': 43219, 'Country': 'United States', 'Contact Number': '1 614 543 8099', 'First Name': 'Thomas', 'Last Name': 'Shelby', 'Job Title': 'Chief Executive Officer', 'Email': 'rajendraprasadkunamalla@gmail.com', 'Linkedin URL': 'https://wwwlinkedincom/in/muratkberme/', 'lead_type': 'cold', 'outbound message': "Subject: Optimizing Efficiency with AI Automation for Bertec Corporation\\n\\nDear Thomas,\\n\\nI hope this email finds you well.\\n\\nMy name is [Your Name] and I'm reaching out from [Your Company], a leading provider of AI-powered automation solutions.\\n\\nI noticed Bertec Corporation's impressive work in the Health, Wellness & Fitness industry, and I believe AI automation could significantly enhance your operations.\\n\\nWould you be open to a brief conversation to discuss how AI could streamline processes, improve efficiency, and drive innovation at Bertec Corporation?\\n\\nI'm confident that AI solutions can bring substantial value to your business. Please let me know your availability for a quick call.\\n\\nBest regards,\\n[Your Name] \\n", 'Initial contact': 'No'}]
# gmail_send_message(sender,recepient,subject,content):
# 'outbound message': "Subject:  Streamlining Mental Health Care with AI Automation \\n\\nHi Nagaraj Nippu,\\n\\nI came across All Points North's impressive work in the mental health space and was excited to learn more about your organization. \\n\\nAs a leader in AI automation, we've seen how technology can significantly improve efficiency and care delivery in the healthcare industry. \\n\\nI'd be interested in connecting to discuss how AI solutions could potentially benefit All Points North.  Would you be open to a brief conversation?\\n\\nBest regards,\\n\\n[Your Name] \\n"
# # Extract subject
# subject_regex = r"(?<=Subject:\s)(.*?)(?=\\n\\n)"
# subject = re.search(subject_regex, text).group(0)

# # Extract message body
# messagebody_regex = r"(?<=\\n\\n)(.*)"
# message_body = re.search(messagebody_regex, text).group(0)
import re
subject_regex = r"(?<=Subject:\s)(.*?)(?=\\n\\n)"
messagebody_regex = r"(?<=\\n\\n)(.*)"
mail_batch_initial = []
for entry in output:
    lead_details = {}
    lead_details['recepient'] = entry['Email']
    lead_details['subject'] = re.search(subject_regex, entry['outbound message']).group()
    lead_details['content'] = re.search(messagebody_regex, entry['outbound message']).group()
    mail_batch_initial.append(lead_details)
import textwrap
def format_email_content(content):
    """Replace literal '\n' with actual newline characters."""
    # Replace the escape sequence '\n' with an actual newline
    formatted_content = content.replace("\\n", "\n").replace("\n", "\n")
    return formatted_content

for i in mail_batch_initial:
    print(format_email_content(i['content']),'\n')
